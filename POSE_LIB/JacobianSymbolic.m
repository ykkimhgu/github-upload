%% Jacobian  Symbolic 



%%  6 variable and 4 points
syms a b c dx dy dz Px Py Pz Px2 Py2 Pz2 Px3 Py3 Pz3 Px4 Py4 Pz4
SP=[Px Py Pz 1]';

M=[ cos(b)*cos(c), cos(c)*sin(a)*sin(b) - cos(a)*sin(c), sin(a)*sin(c) + cos(a)*cos(c)*sin(b), dx;...
cos(b)*sin(c), cos(a)*cos(c) + sin(a)*sin(b)*sin(c), cos(a)*sin(b)*sin(c) - cos(c)*sin(a), dy;...
       -sin(b),                        cos(b)*sin(a),                        cos(a)*cos(b), dz;...
       0,0,0,1];
OP=M*SP;
J0=jacobian(OP,[a b c dx dy dz])

J1=[   conj(Py)*(sin(a)*sin(c) + cos(a)*cos(c)*sin(b)) + conj(Pz)*(cos(a)*sin(c) - cos(c)*sin(a)*sin(b)), conj(Pz)*cos(a)*cos(b)*cos(c) - conj(Px)*cos(c)*sin(b) + conj(Py)*cos(b)*cos(c)*sin(a), conj(Pz)*(cos(c)*sin(a) - cos(a)*sin(b)*sin(c)) - conj(Py)*(cos(a)*cos(c) + sin(a)*sin(b)*sin(c)) - conj(Px)*cos(b)*sin(c), 1, 0, 0];
J2=[ - conj(Py)*(cos(c)*sin(a) - cos(a)*sin(b)*sin(c)) - conj(Pz)*(cos(a)*cos(c) + sin(a)*sin(b)*sin(c)), conj(Pz)*cos(a)*cos(b)*sin(c) - conj(Px)*sin(b)*sin(c) + conj(Py)*cos(b)*sin(a)*sin(c), conj(Pz)*(sin(a)*sin(c) + cos(a)*cos(c)*sin(b)) - conj(Py)*(cos(a)*sin(c) - cos(c)*sin(a)*sin(b)) + conj(Px)*cos(b)*cos(c), 0, 1, 0];
J3=[                                                     conj(Py)*cos(a)*cos(b) - conj(Pz)*cos(b)*sin(a),                    - conj(Px)*cos(b) - conj(Pz)*cos(a)*sin(b) - conj(Py)*sin(a)*sin(b),                                                                                                                          0, 0, 0, 1];

J4=[   conj(Py2)*(sin(a)*sin(c) + cos(a)*cos(c)*sin(b)) + conj(Pz2)*(cos(a)*sin(c) - cos(c)*sin(a)*sin(b)), conj(Pz2)*cos(a)*cos(b)*cos(c) - conj(Px2)*cos(c)*sin(b) + conj(Py2)*cos(b)*cos(c)*sin(a), conj(Pz2)*(cos(c)*sin(a) - cos(a)*sin(b)*sin(c)) - conj(Py2)*(cos(a)*cos(c) + sin(a)*sin(b)*sin(c)) - conj(Px2)*cos(b)*sin(c), 1, 0, 0];
J5=[ - conj(Py2)*(cos(c)*sin(a) - cos(a)*sin(b)*sin(c)) - conj(Pz2)*(cos(a)*cos(c) + sin(a)*sin(b)*sin(c)), conj(Pz2)*cos(a)*cos(b)*sin(c) - conj(Px2)*sin(b)*sin(c) + conj(Py2)*cos(b)*sin(a)*sin(c), conj(Pz2)*(sin(a)*sin(c) + cos(a)*cos(c)*sin(b)) - conj(Py2)*(cos(a)*sin(c) - cos(c)*sin(a)*sin(b)) + conj(Px2)*cos(b)*cos(c), 0, 1, 0];
J6=[                                                     conj(Py2)*cos(a)*cos(b) - conj(Pz2)*cos(b)*sin(a),                    - conj(Px2)*cos(b) - conj(Pz2)*cos(a)*sin(b) - conj(Py2)*sin(a)*sin(b),                                                                                                                          0, 0, 0, 1];


J7=[   conj(Py3)*(sin(a)*sin(c) + cos(a)*cos(c)*sin(b)) + conj(Pz3)*(cos(a)*sin(c) - cos(c)*sin(a)*sin(b)), conj(Pz3)*cos(a)*cos(b)*cos(c) - conj(Px3)*cos(c)*sin(b) + conj(Py3)*cos(b)*cos(c)*sin(a), conj(Pz3)*(cos(c)*sin(a) - cos(a)*sin(b)*sin(c)) - conj(Py3)*(cos(a)*cos(c) + sin(a)*sin(b)*sin(c)) - conj(Px3)*cos(b)*sin(c), 1, 0, 0];
J8=[ - conj(Py3)*(cos(c)*sin(a) - cos(a)*sin(b)*sin(c)) - conj(Pz3)*(cos(a)*cos(c) + sin(a)*sin(b)*sin(c)), conj(Pz3)*cos(a)*cos(b)*sin(c) - conj(Px3)*sin(b)*sin(c) + conj(Py3)*cos(b)*sin(a)*sin(c), conj(Pz3)*(sin(a)*sin(c) + cos(a)*cos(c)*sin(b)) - conj(Py3)*(cos(a)*sin(c) - cos(c)*sin(a)*sin(b)) + conj(Px3)*cos(b)*cos(c), 0, 1, 0];
J9=[                                                     conj(Py3)*cos(a)*cos(b) - conj(Pz3)*cos(b)*sin(a),                    - conj(Px3)*cos(b) - conj(Pz3)*cos(a)*sin(b) - conj(Py3)*sin(a)*sin(b),                                                                                                                          0, 0, 0, 1];

J10=[   conj(Py4)*(sin(a)*sin(c) + cos(a)*cos(c)*sin(b)) + conj(Pz4)*(cos(a)*sin(c) - cos(c)*sin(a)*sin(b)), conj(Pz4)*cos(a)*cos(b)*cos(c) - conj(Px4)*cos(c)*sin(b) + conj(Py4)*cos(b)*cos(c)*sin(a), conj(Pz4)*(cos(c)*sin(a) - cos(a)*sin(b)*sin(c)) - conj(Py4)*(cos(a)*cos(c) + sin(a)*sin(b)*sin(c)) - conj(Px4)*cos(b)*sin(c), 1, 0, 0];
J11=[ - conj(Py4)*(cos(c)*sin(a) - cos(a)*sin(b)*sin(c)) - conj(Pz4)*(cos(a)*cos(c) + sin(a)*sin(b)*sin(c)), conj(Pz4)*cos(a)*cos(b)*sin(c) - conj(Px4)*sin(b)*sin(c) + conj(Py4)*cos(b)*sin(a)*sin(c), conj(Pz4)*(sin(a)*sin(c) + cos(a)*cos(c)*sin(b)) - conj(Py4)*(cos(a)*sin(c) - cos(c)*sin(a)*sin(b)) + conj(Px4)*cos(b)*cos(c), 0, 1, 0];
J12=[                                                     conj(Py4)*cos(a)*cos(b) - conj(Pz4)*cos(b)*sin(a),                    - conj(Px4)*cos(b) - conj(Pz4)*cos(a)*sin(b) - conj(Py4)*sin(a)*sin(b),                                                                                                                          0, 0, 0, 1];

J=[J1;J2;J3;J4;J5;J6;J7;J8;J9;J10;J11;J12];
JpseudoInv=inv(J'*J)*J'
rank(JpseudoInv)


%%  4 variable and 2 points

syms a dx dy dz Px Py Pz Px2 Py2 Pz2 Qx Qy Qz
SP=[Px Py Pz 1]';
  
M=[1 0 0 dx; 0 cos(a) -sin(a) dy;0 sin(a) cos(a) dz;0,0,0,1];
OP=M*SP;
J0=jacobian(OP,[a dx dy dz])

J1 =[                               0, 1, 0, 0;
 - conj(Pz)*cos(a) - conj(Py)*sin(a), 0, 1, 0;
   conj(Py)*cos(a) - conj(Pz)*sin(a), 0, 0, 1;]

J2 =[                               0, 1, 0, 0;
 - conj(Pz2)*cos(a) - conj(Py2)*sin(a), 0, 1, 0;
   conj(Py2)*cos(a) - conj(Pz2)*sin(a), 0, 0, 1;]
J=[J1;J2];
JpseudoInv=inv(J'*J)*J'
rank(JpseudoInv)

Q=[Qx Qy Qz 1]';
Qtemp=M*Q
MQ=[Qtemp(1:3);Qtemp(1:3)];


JMQ=JpseudoInv*MQ;
X=JMQ;  % X= errorin variables(a, dx, dy, dz)

% X=[((2*(Py*cos(conj(a)) - Pz*sin(conj(a))))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)) - (Py*cos(conj(a)) + Py2*cos(conj(a)) - Pz*sin(conj(a)) - Pz2*sin(conj(a)))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)))*(dz + conj(Qz)*cos(a) + conj(Qy)*sin(a)) - ((2*(Pz2*cos(conj(a)) + Py2*sin(conj(a))))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)) - (Pz*cos(conj(a)) + Pz2*cos(conj(a)) + Py*sin(conj(a)) + Py2*sin(conj(a)))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)))*(dy + conj(Qy)*cos(a) - conj(Qz)*sin(a)) - ((2*(Pz*cos(conj(a)) + Py*sin(conj(a))))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)) - (Pz*cos(conj(a)) + Pz2*cos(conj(a)) + Py*sin(conj(a)) + Py2*sin(conj(a)))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)))*(dy + conj(Qy)*cos(a) - conj(Qz)*sin(a)) + ((2*(Py2*cos(conj(a)) - Pz2*sin(conj(a))))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)) - (Py*cos(conj(a)) + Py2*cos(conj(a)) - Pz*sin(conj(a)) - Pz2*sin(conj(a)))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)))*(dz + conj(Qz)*cos(a) + conj(Qy)*sin(a));
%                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  dx + conj(Qx);
%  ((Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + 2*Pz*cos(conj(a))*conj(Pz)*cos(a) + 2*Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + 2*Py*sin(conj(a))*conj(Pz)*cos(a) + 2*Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + 2*Py2*sin(conj(a))*conj(Pz2)*cos(a) + 2*Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + 2*Py*sin(conj(a))*conj(Py)*sin(a) + 2*Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a))/(2*(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a))) - ((Pz*cos(conj(a)) + Py*sin(conj(a)))*(conj(Pz)*cos(a) + conj(Pz2)*cos(a) + conj(Py)*sin(a) + conj(Py2)*sin(a)))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)))*(dy + conj(Qy)*cos(a) - conj(Qz)*sin(a)) - ((Py*cos(conj(a))*conj(Pz)*cos(a) + Py*cos(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*cos(a) + Py2*cos(conj(a))*conj(Pz2)*cos(a) + Py*cos(conj(a))*conj(Py)*sin(a) + Py*cos(conj(a))*conj(Py2)*sin(a) + Py2*cos(conj(a))*conj(Py)*sin(a) + Py2*cos(conj(a))*conj(Py2)*sin(a) - Pz*sin(conj(a))*conj(Pz)*cos(a) - Pz*sin(conj(a))*conj(Pz2)*cos(a) - Pz2*sin(conj(a))*conj(Pz)*cos(a) - Pz2*sin(conj(a))*conj(Pz2)*cos(a) - Pz*sin(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*sin(a))/(2*(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a))) - ((Py2*cos(conj(a)) - Pz2*sin(conj(a)))*(conj(Pz)*cos(a) + conj(Pz2)*cos(a) + conj(Py)*sin(a) + conj(Py2)*sin(a)))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)))*(dz + conj(Qz)*cos(a) + conj(Qy)*sin(a)) - ((Py*cos(conj(a))*conj(Pz)*cos(a) + Py*cos(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*cos(a) + Py2*cos(conj(a))*conj(Pz2)*cos(a) + Py*cos(conj(a))*conj(Py)*sin(a) + Py*cos(conj(a))*conj(Py2)*sin(a) + Py2*cos(conj(a))*conj(Py)*sin(a) + Py2*cos(conj(a))*conj(Py2)*sin(a) - Pz*sin(conj(a))*conj(Pz)*cos(a) - Pz*sin(conj(a))*conj(Pz2)*cos(a) - Pz2*sin(conj(a))*conj(Pz)*cos(a) - Pz2*sin(conj(a))*conj(Pz2)*cos(a) - Pz*sin(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*sin(a))/(2*(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a))) - ((Py*cos(conj(a)) - Pz*sin(conj(a)))*(conj(Pz)*cos(a) + conj(Pz2)*cos(a) + conj(Py)*sin(a) + conj(Py2)*sin(a)))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)))*(dz + conj(Qz)*cos(a) + conj(Qy)*sin(a)) + ((Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + 2*Pz*cos(conj(a))*conj(Pz)*cos(a) + 2*Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + 2*Py*sin(conj(a))*conj(Pz)*cos(a) + 2*Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + 2*Py2*sin(conj(a))*conj(Pz2)*cos(a) + 2*Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + 2*Py*sin(conj(a))*conj(Py)*sin(a) + 2*Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a))/(2*(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a))) - ((Pz2*cos(conj(a)) + Py2*sin(conj(a)))*(conj(Pz)*cos(a) + conj(Pz2)*cos(a) + conj(Py)*sin(a) + conj(Py2)*sin(a)))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)))*(dy + conj(Qy)*cos(a) - conj(Qz)*sin(a));
%                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      (((Pz*cos(conj(a)) + Py*sin(conj(a)))*(conj(Py)*cos(a) + conj(Py2)*cos(a) - conj(Pz)*sin(a) - conj(Pz2)*sin(a)))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)) - ((Pz*cos(conj(a)) + Pz2*cos(conj(a)) + Py*sin(conj(a)) + Py2*sin(conj(a)))*(conj(Py)*cos(a) + conj(Py2)*cos(a) - conj(Pz)*sin(a) - conj(Pz2)*sin(a)))/(2*(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a))))*(dy + conj(Qy)*cos(a) - conj(Qz)*sin(a)) + (((Pz2*cos(conj(a)) + Py2*sin(conj(a)))*(conj(Py)*cos(a) + conj(Py2)*cos(a) - conj(Pz)*sin(a) - conj(Pz2)*sin(a)))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)) - ((Pz*cos(conj(a)) + Pz2*cos(conj(a)) + Py*sin(conj(a)) + Py2*sin(conj(a)))*(conj(Py)*cos(a) + conj(Py2)*cos(a) - conj(Pz)*sin(a) - conj(Pz2)*sin(a)))/(2*(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a))))*(dy + conj(Qy)*cos(a) - conj(Qz)*sin(a)) + ((2*Py*cos(conj(a))*conj(Py)*cos(a) + 2*Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - 2*Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - 2*Pz*sin(conj(a))*conj(Py)*cos(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) - 2*Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - 2*Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + 2*Pz*sin(conj(a))*conj(Pz)*sin(a) + 2*Pz2*sin(conj(a))*conj(Pz2)*sin(a))/(2*(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a))) - ((Py*cos(conj(a)) - Pz*sin(conj(a)))*(conj(Py)*cos(a) + conj(Py2)*cos(a) - conj(Pz)*sin(a) - conj(Pz2)*sin(a)))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)))*(dz + conj(Qz)*cos(a) + conj(Qy)*sin(a)) + ((2*Py*cos(conj(a))*conj(Py)*cos(a) + 2*Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - 2*Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - 2*Pz*sin(conj(a))*conj(Py)*cos(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) - 2*Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - 2*Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + 2*Pz*sin(conj(a))*conj(Pz)*sin(a) + 2*Pz2*sin(conj(a))*conj(Pz2)*sin(a))/(2*(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a))) - ((Py2*cos(conj(a)) - Pz2*sin(conj(a)))*(conj(Py)*cos(a) + conj(Py2)*cos(a) - conj(Pz)*sin(a) - conj(Pz2)*sin(a)))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)))*(dz + conj(Qz)*cos(a) + conj(Qy)*sin(a))]

%%

Qx=5.8e-3; Qy=13e-3; Qz=0; dz=0; dx=0; dy=0;
a=2*pi/180;

oP1=[-0.2, 0.4, 0]'; oP2=[0.2, 0.4, 0]'; 
lP=[ -0.2000    0.2000    0.2000   -0.2000
    0.4521    0.4521   -0.3474   -0.3474
    1.4851    1.4851    1.5130    1.5130
    1.0000    1.0000    1.0000    1.0000];
    
    
Px=lP(2,1)-Qx
Py=lP(2,2)-Qy
Pz=lP(2,3)+Qz
Px2=lP(3,1)-Qx
Py2=lP(3,2)+Qy
Pz2=lP(3,3)+Qz

X=[((2*(Py*cos(conj(a)) - Pz*sin(conj(a))))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)) - (Py*cos(conj(a)) + Py2*cos(conj(a)) - Pz*sin(conj(a)) - Pz2*sin(conj(a)))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)))*(dz + conj(Qz)*cos(a) + conj(Qy)*sin(a)) - ((2*(Pz2*cos(conj(a)) + Py2*sin(conj(a))))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)) - (Pz*cos(conj(a)) + Pz2*cos(conj(a)) + Py*sin(conj(a)) + Py2*sin(conj(a)))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)))*(dy + conj(Qy)*cos(a) - conj(Qz)*sin(a)) - ((2*(Pz*cos(conj(a)) + Py*sin(conj(a))))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)) - (Pz*cos(conj(a)) + Pz2*cos(conj(a)) + Py*sin(conj(a)) + Py2*sin(conj(a)))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)))*(dy + conj(Qy)*cos(a) - conj(Qz)*sin(a)) + ((2*(Py2*cos(conj(a)) - Pz2*sin(conj(a))))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)) - (Py*cos(conj(a)) + Py2*cos(conj(a)) - Pz*sin(conj(a)) - Pz2*sin(conj(a)))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)))*(dz + conj(Qz)*cos(a) + conj(Qy)*sin(a));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 dx + conj(Qx);
 ((Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + 2*Pz*cos(conj(a))*conj(Pz)*cos(a) + 2*Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + 2*Py*sin(conj(a))*conj(Pz)*cos(a) + 2*Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + 2*Py2*sin(conj(a))*conj(Pz2)*cos(a) + 2*Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + 2*Py*sin(conj(a))*conj(Py)*sin(a) + 2*Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a))/(2*(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a))) - ((Pz*cos(conj(a)) + Py*sin(conj(a)))*(conj(Pz)*cos(a) + conj(Pz2)*cos(a) + conj(Py)*sin(a) + conj(Py2)*sin(a)))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)))*(dy + conj(Qy)*cos(a) - conj(Qz)*sin(a)) - ((Py*cos(conj(a))*conj(Pz)*cos(a) + Py*cos(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*cos(a) + Py2*cos(conj(a))*conj(Pz2)*cos(a) + Py*cos(conj(a))*conj(Py)*sin(a) + Py*cos(conj(a))*conj(Py2)*sin(a) + Py2*cos(conj(a))*conj(Py)*sin(a) + Py2*cos(conj(a))*conj(Py2)*sin(a) - Pz*sin(conj(a))*conj(Pz)*cos(a) - Pz*sin(conj(a))*conj(Pz2)*cos(a) - Pz2*sin(conj(a))*conj(Pz)*cos(a) - Pz2*sin(conj(a))*conj(Pz2)*cos(a) - Pz*sin(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*sin(a))/(2*(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a))) - ((Py2*cos(conj(a)) - Pz2*sin(conj(a)))*(conj(Pz)*cos(a) + conj(Pz2)*cos(a) + conj(Py)*sin(a) + conj(Py2)*sin(a)))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)))*(dz + conj(Qz)*cos(a) + conj(Qy)*sin(a)) - ((Py*cos(conj(a))*conj(Pz)*cos(a) + Py*cos(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*cos(a) + Py2*cos(conj(a))*conj(Pz2)*cos(a) + Py*cos(conj(a))*conj(Py)*sin(a) + Py*cos(conj(a))*conj(Py2)*sin(a) + Py2*cos(conj(a))*conj(Py)*sin(a) + Py2*cos(conj(a))*conj(Py2)*sin(a) - Pz*sin(conj(a))*conj(Pz)*cos(a) - Pz*sin(conj(a))*conj(Pz2)*cos(a) - Pz2*sin(conj(a))*conj(Pz)*cos(a) - Pz2*sin(conj(a))*conj(Pz2)*cos(a) - Pz*sin(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*sin(a))/(2*(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a))) - ((Py*cos(conj(a)) - Pz*sin(conj(a)))*(conj(Pz)*cos(a) + conj(Pz2)*cos(a) + conj(Py)*sin(a) + conj(Py2)*sin(a)))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)))*(dz + conj(Qz)*cos(a) + conj(Qy)*sin(a)) + ((Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + 2*Pz*cos(conj(a))*conj(Pz)*cos(a) + 2*Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + 2*Py*sin(conj(a))*conj(Pz)*cos(a) + 2*Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + 2*Py2*sin(conj(a))*conj(Pz2)*cos(a) + 2*Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + 2*Py*sin(conj(a))*conj(Py)*sin(a) + 2*Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a))/(2*(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a))) - ((Pz2*cos(conj(a)) + Py2*sin(conj(a)))*(conj(Pz)*cos(a) + conj(Pz2)*cos(a) + conj(Py)*sin(a) + conj(Py2)*sin(a)))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)))*(dy + conj(Qy)*cos(a) - conj(Qz)*sin(a));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     (((Pz*cos(conj(a)) + Py*sin(conj(a)))*(conj(Py)*cos(a) + conj(Py2)*cos(a) - conj(Pz)*sin(a) - conj(Pz2)*sin(a)))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)) - ((Pz*cos(conj(a)) + Pz2*cos(conj(a)) + Py*sin(conj(a)) + Py2*sin(conj(a)))*(conj(Py)*cos(a) + conj(Py2)*cos(a) - conj(Pz)*sin(a) - conj(Pz2)*sin(a)))/(2*(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a))))*(dy + conj(Qy)*cos(a) - conj(Qz)*sin(a)) + (((Pz2*cos(conj(a)) + Py2*sin(conj(a)))*(conj(Py)*cos(a) + conj(Py2)*cos(a) - conj(Pz)*sin(a) - conj(Pz2)*sin(a)))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)) - ((Pz*cos(conj(a)) + Pz2*cos(conj(a)) + Py*sin(conj(a)) + Py2*sin(conj(a)))*(conj(Py)*cos(a) + conj(Py2)*cos(a) - conj(Pz)*sin(a) - conj(Pz2)*sin(a)))/(2*(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a))))*(dy + conj(Qy)*cos(a) - conj(Qz)*sin(a)) + ((2*Py*cos(conj(a))*conj(Py)*cos(a) + 2*Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - 2*Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - 2*Pz*sin(conj(a))*conj(Py)*cos(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) - 2*Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - 2*Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + 2*Pz*sin(conj(a))*conj(Pz)*sin(a) + 2*Pz2*sin(conj(a))*conj(Pz2)*sin(a))/(2*(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a))) - ((Py*cos(conj(a)) - Pz*sin(conj(a)))*(conj(Py)*cos(a) + conj(Py2)*cos(a) - conj(Pz)*sin(a) - conj(Pz2)*sin(a)))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)))*(dz + conj(Qz)*cos(a) + conj(Qy)*sin(a)) + ((2*Py*cos(conj(a))*conj(Py)*cos(a) + 2*Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - 2*Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - 2*Pz*sin(conj(a))*conj(Py)*cos(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) - 2*Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - 2*Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + 2*Pz*sin(conj(a))*conj(Pz)*sin(a) + 2*Pz2*sin(conj(a))*conj(Pz2)*sin(a))/(2*(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a))) - ((Py2*cos(conj(a)) - Pz2*sin(conj(a)))*(conj(Py)*cos(a) + conj(Py2)*cos(a) - conj(Pz)*sin(a) - conj(Pz2)*sin(a)))/(Py*cos(conj(a))*conj(Py)*cos(a) - Py*cos(conj(a))*conj(Py2)*cos(a) - Py2*cos(conj(a))*conj(Py)*cos(a) + Py2*cos(conj(a))*conj(Py2)*cos(a) + Pz*cos(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Pz2)*cos(a) - Pz2*cos(conj(a))*conj(Pz)*cos(a) + Pz2*cos(conj(a))*conj(Pz2)*cos(a) - Py*cos(conj(a))*conj(Pz)*sin(a) + Py*sin(conj(a))*conj(Pz)*cos(a) + Pz*cos(conj(a))*conj(Py)*sin(a) - Pz*sin(conj(a))*conj(Py)*cos(a) + Py*cos(conj(a))*conj(Pz2)*sin(a) - Py*sin(conj(a))*conj(Pz2)*cos(a) + Py2*cos(conj(a))*conj(Pz)*sin(a) - Py2*sin(conj(a))*conj(Pz)*cos(a) - Pz*cos(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Py2)*cos(a) - Pz2*cos(conj(a))*conj(Py)*sin(a) + Pz2*sin(conj(a))*conj(Py)*cos(a) - Py2*cos(conj(a))*conj(Pz2)*sin(a) + Py2*sin(conj(a))*conj(Pz2)*cos(a) + Pz2*cos(conj(a))*conj(Py2)*sin(a) - Pz2*sin(conj(a))*conj(Py2)*cos(a) + Py*sin(conj(a))*conj(Py)*sin(a) - Py*sin(conj(a))*conj(Py2)*sin(a) - Py2*sin(conj(a))*conj(Py)*sin(a) + Py2*sin(conj(a))*conj(Py2)*sin(a) + Pz*sin(conj(a))*conj(Pz)*sin(a) - Pz*sin(conj(a))*conj(Pz2)*sin(a) - Pz2*sin(conj(a))*conj(Pz)*sin(a) + Pz2*sin(conj(a))*conj(Pz2)*sin(a)))*(dz + conj(Qz)*cos(a) + conj(Qy)*sin(a))]
X(1)*180/pi

Z=1.5;a=2; L=0.2; ey=Z*tand(0.5)
alpha_del= (90-a)-atand( (L*cosd(a)-ey) / (L*sind(a)) )